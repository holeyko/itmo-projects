start: s
accept: ac
reject: rj
blank: _
s 0 -> sep 0 <
s 1 -> sep 1 <

sep _ -> firZero | <

firZero _ -> prMul 0 >

prMul 0 -> prMul 0 >
prMul 1 -> prMul 1 >
prMul | -> prMul | >
prMul * -> prMul * >
prMul _ -> mul _ <

mul 0 -> mul x <
mul 1 -> fdZero y >
mul * -> prRemNum * >

fdZero x -> prAddZero y <
fdZero y -> fdZero y >
fdZero 0 -> fdZero 0 >
fdZero 1 -> fdZero 1 >
fdZero a -> fdZero a >
fdZero b -> fdZero b >
fdZero | -> fdZero | >
fdZero * -> fdZero * >
fdZero _ -> prAddNum _ <

prAddZero y -> prAddZero y <
prAddZero 0 -> prAddZero 0 <
prAddZero 1 -> prAddZero 1 <
prAddZero * -> prAddZero * <
prAddZero | -> addZero | <

addZero a -> addZero a <
addZero b -> addZero b <
addZero 0 -> fdZero a >
addZero 1 -> fdZero b >
addZero _ -> fdZero a >

prAddNum y -> prAddNum x <
prAddNum 0 -> prAddNum 0 <
prAddNum 1 -> prAddNum 1 <
prAddNum * -> add * <

add 0 -> prAdd0 a <
add 1 -> prAdd1 b <
add a -> add a <
add b -> add b <
add | -> prEndAdd | <

prAdd0 0 -> prAdd0 0 <
prAdd0 1 -> prAdd0 1 <
prAdd0 | -> add0 | <

prAdd1 0 -> prAdd1 0 <
prAdd1 1 -> prAdd1 1 <
prAdd1 | -> add1 | <

add0 0 -> retAdd a >
add0 1 -> retAdd b >
add0 a -> add0 a <
add0 b -> add0 b <
add0 _ -> retAdd a >

add1 0 -> retAdd b >
add1 _ -> retAdd b >
add1 1 -> addD1 a <
add1 a -> add1 a <
add1 b -> add1 b <

addD1 0 -> retAdd 1 >
addD1 1 -> addD1 0 <
addD1 _ -> retAdd 1 >

retAdd 0 -> retAdd 0 >
retAdd 1 -> retAdd 1 >
retAdd a -> retAdd a >
retAdd b -> retAdd b >
retAdd | -> retAdd | >
retAdd * -> add * <

prEndAdd 0 -> prEndAdd 0 <
prEndAdd 1 -> prEndAdd 1 <
prEndAdd a -> prEndAdd a <
prEndAdd b -> prEndAdd b <
prEndAdd _ -> endAdd _ >

endAdd 0 -> endAdd 0 >
endAdd 1 -> endAdd 1 >
endAdd a -> endAdd 0 >
endAdd b -> endAdd 1 >
endAdd | -> endAdd | >
endAdd * -> endAdd * >
endAdd x -> mul x <
endAdd _ -> mul _ <

prRemNum x -> prRemNum x >
prRemNum _ -> remNum _ <

remNum x -> remNum _ <
remNum * -> remNum _ <
remNum 0 -> remNum _ <
remNum 1 -> remNum _ <
remNum a -> remNum _ <
remNum b -> remNum _ <
remNum | -> prClean _ <

prClean 0 -> prClean 0 <
prClean 1 -> prClean 1 <
prClean a -> prClean 0 <
prClean b -> prClean 1 <
prClean _ -> clean _ >

clean 0 -> clean _ >
clean 1 -> ac 1 ^
clean _ -> ac 0 ^
